#using "class.gm"

rule amap(ref a:array<Simple>) : (array<int>)
{
	if{ a.map<int>{s:Simple -> s.i}.sum() == 3 ; }
	
	modify {
		return(a.map<int>{s:Simple -> s.i});
	}
}

rule aremoveif(ref a:array<Simple>) : (array<Simple>)
{
	if{ a.removeIf{s:Simple -> s.i == 1}.size() == 3 ; }
	
	modify {
		return(a.removeIf{s:Simple -> s.i == 1});
	}
}

rule cmap(ref a:array<Simple>)
{
	modify {
	---
		exec({ ::o = a.map<int>{s:Simple -> s.i} });
	}
}

rule cremoveif(ref a:array<Simple>)
{
	modify {
	---
		exec({ ::o = a.removeIf{s:Simple -> s.i == 1} });
	}
}


procedure emitSimpleArray(var name:string, ref a:array<Simple>)
{
	emit("The value of variable \"", name, "\" of type array<Simple> is: ");
	emit("\"[");
	def var first:boolean = true;
	for(elem:Simple in a)
	{
		if(first) {
			first = false;
		} else {
			emit(",");
		}
		emit("Simple{i:" + elem.i + ",j:" + elem.j + "}");
	}
	emit("]\"\n");
	return;
}
