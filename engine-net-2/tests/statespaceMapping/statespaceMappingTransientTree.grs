new graph statespaceMapping/statespace

include statespaceMapping/statespacelayout.grsi

exec init ;> ::statespaceRoot = new TransientStatespaceObject@(gr=this)

exec { ::statespace = new set<graph>{} }

def stateStepMappingTransientTree(level:int, parent:TransientStatespaceObject) { false }
def stateStepMappingTransientTree(level:int, parent:TransientStatespaceObject) {\
	if { {{level < ::stopLevel}};\
		{ ::statestep = [: for{insertRed; child:TransientStatespaceObject ;> {::statespace.add(this); child = new TransientStatespaceObject@(gr=this); parent.successors.add(child) } ;> stateStepMappingTransientTree(level + 1, child)},\
							for{insertGreen; child:TransientStatespaceObject ;> {::statespace.add(this); child = new TransientStatespaceObject@(gr=this); parent.successors.add(child) } ;> stateStepMappingTransientTree(level + 1, child)},\
							for{insertBlue; child:TransientStatespaceObject ;> {::statespace.add(this); child = new TransientStatespaceObject@(gr=this); parent.successors.add(child) } ;> stateStepMappingTransientTree(level + 1, child)}\
						:] }\
	}\
}

exec ::stopLevel=2 ;> stateStepMappingTransientTree(0, ::statespaceRoot)

show var statestep
show var statespace

show var statespaceRoot
show transient object statespaceRoot

exec { ::statespaceRootChild0 = ::statespaceRoot.successors.peek(0) }
exec { ::statespaceRootChild1 = ::statespaceRoot.successors.peek(1) }
exec { ::statespaceRootChild2 = ::statespaceRoot.successors.peek(2) }
show transient object statespaceRootChild0
show transient object statespaceRootChild1
show transient object statespaceRootChild2

exec { ::statespaceRootChild00 = ::statespaceRootChild0.successors.peek(0) }
exec { ::statespaceRootChild01 = ::statespaceRootChild0.successors.peek(1) }
exec { ::statespaceRootChild02 = ::statespaceRootChild0.successors.peek(2) }
exec { ::statespaceRootChild03 = ::statespaceRootChild0.successors.peek(3) }
show transient object statespaceRootChild00
show transient object statespaceRootChild01
show transient object statespaceRootChild02
show transient object statespaceRootChild03

#note: the TransientStatespaceObject are created outside of the graphs (in contrast to the StatespaceObject of the non-transient tests)

show num nodes Red
show num nodes Green
show num nodes Blue

exec for{g:graph in ::statespace; in g { { emit("The value of variable \"redgreenblue\" of type foobar is: ", nodes(Red).size(), nodes(Green).size(), nodes(Blue).size(), "\n") } } } 

exit
